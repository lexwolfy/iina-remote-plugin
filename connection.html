<!DOCTYPE html><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>IINA Web Remote - Connection</title><script src=https://cdn.tailwindcss.com></script><script>tailwind.config={theme:{extend:{colors:{iina:{bg:"#1a1a1a",surface:"#2d2d2d","surface-light":"#3a3a3a",primary:"#007AFF",secondary:"#5856D6",text:"#ffffff","text-muted":"#a0a0a0"}},fontFamily:{sans:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","sans-serif"],mono:["SF Mono","Monaco","Inconsolata","Fira Code","monospace"]}}}};</script><style>@layer components{@apply bg-iina-surface/80 backdrop-blur-md rounded-2xl p-4 border border-white/10;@apply bg-iina-surface hover:bg-iina-surface-light active:bg-iina-surface-light/80 text-iina-text border border-white/10 rounded-xl transition-all duration-200 ease-out flex items-center justify-center touch-manipulation select-none min-h-[44px]min-w-[44px];@apply bg-iina-primary hover:bg-blue-600 active:bg-blue-700 text-white border-0 rounded-xl transition-all duration-200 ease-out flex items-center justify-center touch-manipulation select-none min-h-[44px]min-w-[44px];}</style><body class="bg-iina-bg font-sans text-iina-text">
    <div class="min-h-screen p-6">
        <div class="max-w-2xl mx-auto">
            
            <div class="mb-8 text-center">
                <h1 class="font-bold mb-2 text-3xl">üé¨ IINA Web Remote</h1>
                <p class=text-iina-text-muted>Connect your devices to control IINA remotely</p>
            </div>
            
            
            <div class="iina-control-bar mb-6">
                <div id=status class="duration-300 flex items-center justify-center p-4 rounded-xl transition-all">
                    <div class="animate-spin border-2 border-iina-text-muted border-t-iina-primary h-5 loading mr-3 rounded-full w-5"></div>
                    <span>Getting connection info...</span>
                </div>
            </div>
            
            
            <div class="iina-control-bar mb-6">
                <div class=text-center>
                    <h2 class="font-semibold mb-4 text-xl">üì± Quick Connect</h2>
                    <div id=qrcode-container class="bg-white inline-block p-6 rounded-2xl">
                        <div id=qrcode class="flex items-center justify-center min-h-[200px] min-w-[200px]">
                            <div class="animate-spin border-3 border-gray-300 border-t-iina-primary h-8 loading rounded-full w-8"></div>
                        </div>
                    </div>
                    <p class="mt-4 text-iina-text-muted text-sm">Scan with your phone to connect instantly</p>
                </div>
            </div>
            
            
            <div class="iina-control-bar mb-6">
                <h2 class="font-semibold mb-4 text-xl">üì° Connection Details</h2>
                <div class=space-y-4>
                    <div class="flex items-center justify-between">
                        <span class=text-iina-text-muted>Status:</span>
                        <span id=serverStatus class=font-mono>Checking...</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class=text-iina-text-muted>Port:</span>
                        <span id=serverPort class=font-mono>-</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class=text-iina-text-muted>Local IP:</span>
                        <span id=localIP class=font-mono>-</span>
                    </div>
                </div>
            </div>
            
            
            <div class="iina-control-bar mb-6">
                <h2 class="font-semibold mb-4 text-xl">üåê Web Interface</h2>
                <div class="bg-iina-surface-light p-4 rounded-xl">
                    <div id=connectionUrl class="break-all font-mono text-iina-text-muted text-sm">
                        Loading...
                    </div>
                </div>
                <p class="mt-2 text-iina-text-muted text-sm">Use this URL on any device connected to the same network</p>
            </div>
            
            
            <div class=iina-control-bar>
                <h2 class="font-semibold mb-4 text-xl">üöÄ How to Connect</h2>
                <ol class="space-y-2 text-iina-text-muted text-sm">
                    <li class="flex items-start">
                        <span class="bg-iina-primary flex flex-shrink-0 h-6 items-center justify-center mr-3 mt-0.5 rounded-full text-white text-xs w-6">1</span>
                        <span>Make sure your device is on the same Wi-Fi network</span>
                    </li>
                    <li class="flex items-start">
                        <span class="bg-iina-primary flex flex-shrink-0 h-6 items-center justify-center mr-3 mt-0.5 rounded-full text-white text-xs w-6">2</span>
                        <span>Scan the QR code with your phone or visit the web interface URL</span>
                    </li>
                    <li class="flex items-start">
                        <span class="bg-iina-primary flex flex-shrink-0 h-6 items-center justify-center mr-3 mt-0.5 rounded-full text-white text-xs w-6">3</span>
                        <span>Start controlling IINA remotely!</span>
                    </li>
                </ol>
            </div>
            
            
            <div class="mt-6 text-center">
                <button id=refreshBtn class="font-medium iina-button-primary px-6 py-3 rounded-xl" onclick=refreshConnection()>
                    üîÑ Refresh Connection
                </button>
            </div>
        </div>
    </div>

    <script>!function(){function t(t,e,r,n){Object.defineProperty(t,e,{get:r,set:n,enumerable:!0,configurable:!0})}function e(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){r(t);return}u.done?e(s):Promise.resolve(s).then(n,o)}"function"==typeof SuppressedError&&SuppressedError;var r,n,o,i,a,u,s,c,f,l,h,d,g,v,p,m,w,y,b,E,x,B,R,A,I,T,L,P,C,M,N,k,U,z,_,O,F,S,D,Q,W,q,$,j,H,J,Z,G,K,V,Y,X,tt,te,tr,tn,to,ti,ta,tu,ts={};t(ts,"create",function(){return r},function(t){return r=t}),t(ts,"toCanvas",function(){return n},function(t){return n=t}),t(ts,"toDataURL",function(){return o},function(t){return o=t}),t(ts,"toString",function(){return i},function(t){return i=t});var tc={};tc=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then};var tf=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];u=function(t){if(!t)throw Error('"version" cannot be null or undefined');if(t<1||t>40)throw Error('"version" should be in range from 1 to 40');return 4*t+17},s=function(t){return tf[t]},c=function(t){for(var e=0;0!==t;)e++,t>>>=1;return e},f=function(t){if("function"!=typeof t)throw Error('"toSJISFunc" is not a valid function.');h=t},l=function(){return void 0!==h},d={bit:1},g={bit:0},v={bit:3},p={bit:2},m=function(t,e){if(t&&void 0!==t.bit&&t.bit>=0&&t.bit<4)return t;try{if("string"!=typeof t)throw Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return d;case"m":case"medium":return g;case"q":case"quartile":return v;case"h":case"high":return p;default:throw Error("Unknown EC Level: "+t)}}catch(t){return e}};var tl={};function th(){this.buffer=[],this.length=0}th.prototype={get:function(t){var e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)==1},put:function(t,e){for(var r=0;r<e;r++)this.putBit((t>>>e-r-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},tl=th;var td={};function tg(t){if(!t||t<1)throw Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}tg.prototype.set=function(t,e,r,n){var o=t*this.size+e;this.data[o]=r,n&&(this.reservedBit[o]=!0)},tg.prototype.get=function(t,e){return this.data[t*this.size+e]},tg.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r},tg.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]},td=tg,w=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,r=u(t),n=145===r?26:2*Math.ceil((r-13)/(2*e-2)),o=[r-7],i=1;i<e-1;i++)o[i]=o[i-1]-n;return o.push(6),o.reverse()},y=function(t){for(var e=[],r=w(t),n=r.length,o=0;o<n;o++)for(var i=0;i<n;i++)(0!==o||0!==i)&&(0!==o||i!==n-1)&&(o!==n-1||0!==i)&&e.push([r[o],r[i]]);return e},b=function(t){var e=u(t);return[[0,0],[e-7,0],[0,e-7]]},E={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};x=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7?parseInt(t,10):void 0},B=function(t){for(var e=t.size,r=0,n=0,o=0,i=null,a=null,u=0;u<e;u++){n=o=0,i=a=null;for(var s=0;s<e;s++){var c=t.get(u,s);c===i?n++:(n>=5&&(r+=3+(n-5)),i=c,n=1),(c=t.get(s,u))===a?o++:(o>=5&&(r+=3+(o-5)),a=c,o=1)}n>=5&&(r+=3+(n-5)),o>=5&&(r+=3+(o-5))}return r},R=function(t){for(var e=t.size,r=0,n=0;n<e-1;n++)for(var o=0;o<e-1;o++){var i=t.get(n,o)+t.get(n,o+1)+t.get(n+1,o)+t.get(n+1,o+1);(4===i||0===i)&&r++}return 3*r},A=function(t){for(var e=t.size,r=0,n=0,o=0,i=0;i<e;i++){n=o=0;for(var a=0;a<e;a++)n=n<<1&2047|t.get(i,a),a>=10&&(1488===n||93===n)&&r++,o=o<<1&2047|t.get(a,i),a>=10&&(1488===o||93===o)&&r++}return 40*r},I=function(t){for(var e=0,r=t.data.length,n=0;n<r;n++)e+=t.data[n];return 10*Math.abs(Math.ceil(100*e/r/5)-10)},T=function(t,e){for(var r=e.size,n=0;n<r;n++)for(var o=0;o<r;o++)e.isReserved(o,n)||e.xor(o,n,function(t,e,r){switch(t){case E.PATTERN000:return(e+r)%2==0;case E.PATTERN001:return e%2==0;case E.PATTERN010:return r%3==0;case E.PATTERN011:return(e+r)%3==0;case E.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case E.PATTERN101:return e*r%2+e*r%3==0;case E.PATTERN110:return(e*r%2+e*r%3)%2==0;case E.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw Error("bad maskPattern:"+t)}}(t,o,n))},L=function(t,e){for(var r=Object.keys(E).length,n=0,o=1/0,i=0;i<r;i++){e(i),T(i,t);var a=B(t)+R(t)+A(t)+I(t);T(i,t),a<o&&(o=a,n=i)}return n};var tv=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],tp=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];P=function(t,e){switch(e){case d:return tv[(t-1)*4+0];case g:return tv[(t-1)*4+1];case v:return tv[(t-1)*4+2];case p:return tv[(t-1)*4+3];default:return}},C=function(t,e){switch(e){case d:return tp[(t-1)*4+0];case g:return tp[(t-1)*4+1];case v:return tp[(t-1)*4+2];case p:return tp[(t-1)*4+3];default:return}};for(var tm={},tw=new Uint8Array(512),ty=new Uint8Array(256),tb=1,tE=0;tE<255;tE++)tw[tE]=tb,ty[tb]=tE,256&(tb<<=1)&&(tb^=285);for(var tx=255;tx<512;tx++)tw[tx]=tw[tx-255];function tB(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}U=function(t,e){return 0===t||0===e?0:tw[ty[t]+ty[e]]},M=function(t,e){for(var r=new Uint8Array(t.length+e.length-1),n=0;n<t.length;n++)for(var o=0;o<e.length;o++)r[n+o]^=U(t[n],e[o]);return r},N=function(t,e){for(var r=new Uint8Array(t);r.length-e.length>=0;){for(var n=r[0],o=0;o<e.length;o++)r[o]^=U(e[o],n);for(var i=0;i<r.length&&0===r[i];)i++;r=r.slice(i)}return r},k=function(t){for(var e=new Uint8Array([1]),r=0;r<t;r++)e=M(e,new Uint8Array([1,tw[r]]));return e},tB.prototype.initialize=function(t){this.degree=t,this.genPoly=k(this.degree)},tB.prototype.encode=function(t){if(!this.genPoly)throw Error("Encoder not initialized");var e=new Uint8Array(t.length+this.degree);e.set(t);var r=N(e,this.genPoly),n=this.degree-r.length;if(n>0){var o=new Uint8Array(this.degree);return o.set(r,n),o}return r},tm=tB,J=function(t){return!isNaN(t)&&t>=1&&t<=40};var tR="[0-9]+",tA="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",tI="(?:(?![A-Z0-9 $%*+\\-./:]|"+(tA=tA.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";Z=RegExp(tA,"g"),G=RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),K=RegExp(tI,"g"),V=RegExp(tR,"g"),Y=RegExp("[A-Z $%*+\\-./:]+","g");var tT=RegExp("^"+tA+"$"),tL=RegExp("^"+tR+"$"),tP=RegExp("^[A-Z0-9 $%*+\\-./:]+$");F={id:"Numeric",bit:1,ccBits:[10,12,14]},S={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},D={id:"Byte",bit:4,ccBits:[8,16,16]},Q={id:"Kanji",bit:8,ccBits:[8,10,12]},W={bit:-1},q=function(t,e){if(!t.ccBits)throw Error("Invalid mode: "+t);if(!J(e))throw Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},$=function(t){return tL.test(t)?F:tP.test(t)?S:tT.test(t)?Q:D},j=function(t){if(t&&t.id)return t.id;throw Error("Invalid mode")},H=function(t,e){if(t&&t.bit&&t.ccBits)return t;try{if("string"!=typeof t)throw Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return F;case"alphanumeric":return S;case"kanji":return Q;case"byte":return D;default:throw Error("Unknown mode: "+t)}}catch(t){return e}};var tC=c(7973);z=function(t,e,r){if(!J(t))throw Error("Invalid QR Code version");void 0===r&&(r=D);var n=(s(t)-C(t,e))*8;if(r===W)return n;var o=n-(q(r,t)+4);switch(r){case F:return Math.floor(o/10*3);case S:return Math.floor(o/11*2);case Q:return Math.floor(o/13);default:return Math.floor(o/8)}},_=function(t,e){var r,n=m(e,g);if(Array.isArray(t)){if(t.length>1){for(var o=1;o<=40;o++)if(function(t,e){var r=0;return t.forEach(function(t){var n=q(t.mode,e)+4;r+=n+t.getBitsLength()}),r}(t,o)<=z(o,n,W))return o;return}if(0===t.length)return 1;r=t[0]}else r=t;return function(t,e,r){for(var n=1;n<=40;n++)if(e<=z(n,r,t))return n}(r.mode,r.getLength(),n)},O=function(t){if(!J(t)||t<7)throw Error("Invalid QR Code version");for(var e=t<<12;c(e)-tC>=0;)e^=7973<<c(e)-tC;return t<<12|e};var tM=c(1335);X=function(t,e){for(var r=t.bit<<3|e,n=r<<10;c(n)-tM>=0;)n^=1335<<c(n)-tM;return(r<<10|n)^21522};var tN={};function tk(t){this.mode=F,this.data=t.toString()}tk.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},tk.prototype.getLength=function(){return this.data.length},tk.prototype.getBitsLength=function(){return tk.getBitsLength(this.data.length)},tk.prototype.write=function(t){for(e=0;e+3<=this.data.length;e+=3)r=parseInt(this.data.substr(e,3),10),t.put(r,10);var e,r,n=this.data.length-e;n>0&&(r=parseInt(this.data.substr(e),10),t.put(r,3*n+1))},tN=tk;var tU={},tz=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function t_(t){this.mode=S,this.data=t}t_.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},t_.prototype.getLength=function(){return this.data.length},t_.prototype.getBitsLength=function(){return t_.getBitsLength(this.data.length)},t_.prototype.write=function(t){var e;for(e=0;e+2<=this.data.length;e+=2){var r=45*tz.indexOf(this.data[e]);r+=tz.indexOf(this.data[e+1]),t.put(r,11)}this.data.length%2&&t.put(tz.indexOf(this.data[e]),6)},tU=t_;var tO={};function tF(t){this.mode=D,"string"==typeof t?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}tF.getBitsLength=function(t){return 8*t},tF.prototype.getLength=function(){return this.data.length},tF.prototype.getBitsLength=function(){return tF.getBitsLength(this.data.length)},tF.prototype.write=function(t){for(var e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)},tO=tF;var tS={};function tD(t){this.mode=Q,this.data=t}"use strict";tD.getBitsLength=function(t){return 13*t},tD.prototype.getLength=function(){return this.data.length},tD.prototype.getBitsLength=function(){return tD.getBitsLength(this.data.length)},tD.prototype.write=function(t){var e;for(e=0;e<this.data.length;e++){var r,n=(r=this.data[e],h(r));if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");n=(n>>>8&255)*192+(255&n),t.put(n,13)}},tS=tD;var tQ={},tW={single_source_shortest_paths:function(t,e,r){var n,o,i,a,u,s,c,f={},l={};l[e]=0;var h=tW.PriorityQueue.make();for(h.push(e,0);!h.empty();)for(i in o=(n=h.pop()).value,a=n.cost,u=t[o]||{})u.hasOwnProperty(i)&&(s=a+u[i],c=l[i],(void 0===l[i]||c>s)&&(l[i]=s,h.push(i,s),f[i]=o));if(void 0!==r&&void 0===l[r])throw Error("Could not find a path from "+e+" to "+r+".");return f},extract_shortest_path_from_predecessor_list:function(t,e){for(var r=[],n=e;n;)r.push(n),t[n],n=t[n];return r.reverse(),r},find_path:function(t,e,r){var n=tW.single_source_shortest_paths(t,e,r);return tW.extract_shortest_path_from_predecessor_list(n,r)},PriorityQueue:{make:function(t){var e,r=tW.PriorityQueue,n={};for(e in t=t||{},r)r.hasOwnProperty(e)&&(n[e]=r[e]);return n.queue=[],n.sorter=t.sorter||r.default_sorter,n},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){this.queue.push({value:t,cost:e}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};function tq(t){return unescape(encodeURIComponent(t)).length}function t$(t,e,r){for(var n,o=[];null!==(n=t.exec(r));)o.push({data:n[0],index:n.index,mode:e,length:n[0].length});return o}function tj(t){var e,r,n=t$(V,F,t),o=t$(Y,S,t);return l()?(e=t$(K,D,t),r=t$(Z,Q,t)):(e=t$(G,D,t),r=[]),n.concat(o,e,r).sort(function(t,e){return t.index-e.index}).map(function(t){return{data:t.data,mode:t.mode,length:t.length}})}function tH(t,e){switch(e){case F:return tN.getBitsLength(t);case S:return tU.getBitsLength(t);case Q:return tS.getBitsLength(t);case D:return tO.getBitsLength(t)}}function tJ(t,e){var r,n=$(t);if((r=H(e,n))!==D&&r.bit<n.bit)throw Error('"'+t+'" cannot be encoded with mode '+j(r)+".\n Suggested mode is: "+j(n));switch(r===Q&&!l()&&(r=D),r){case F:return new tN(t);case S:return new tU(t);case Q:return new tS(t);case D:return new tO(t)}}function tZ(t,e,r){var n,o,i=t.size,a=X(e,r);for(n=0;n<15;n++)o=(a>>n&1)==1,n<6?t.set(n,8,o,!0):n<8?t.set(n+1,8,o,!0):t.set(i-15+n,8,o,!0),n<8?t.set(8,i-n-1,o,!0):n<9?t.set(8,15-n-1+1,o,!0):t.set(8,15-n-1,o,!0);t.set(i-8,8,1,!0)}function tG(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw Error("Invalid hex color: "+t);(3===e.length||4===e.length)&&(e=Array.prototype.concat.apply([],e.map(function(t){return[t,t]}))),6===e.length&&e.push("F","F");var r=parseInt(e.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+e.slice(0,6).join("")}}function tK(t,e){var r=t.a/255,n=e+'="'+t.hex+'"';return r<1?n+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function tV(t,e,r){var n=t+e;return void 0!==r&&(n+=" "+r),n}function tY(t,e,r,n,o){var i=[].slice.call(arguments,1),u=i.length,s="function"==typeof i[u-1];if(!s&&!tc())throw Error("Callback required as last argument");if(s){if(u<2)throw Error("Too few arguments provided");2===u?(o=r,r=e,e=n=void 0):3===u&&(e.getContext&&void 0===o?(o=n,n=void 0):(o=n,n=r,r=e,e=void 0))}else{if(u<1)throw Error("Too few arguments provided");return 1===u?(r=e,e=n=void 0):2!==u||e.getContext||(n=r,r=e,e=void 0),new Promise(function(o,i){try{var u=a(r,n);o(t(u,e,n))}catch(t){i(t)}})}try{var c=a(r,n);o(null,t(c,e,n))}catch(t){o(t)}}tQ=tW,tt=function(t){return t.reduce(function(t,e){return"string"==typeof e?t.push(tJ(e,null)):e.data&&t.push(tJ(e.data,e.mode)),t},[])},te=function(t,e){for(var r=function(t,e){for(var r={},n={start:{}},o=["start"],i=0;i<t.length;i++){for(var a=t[i],u=[],s=0;s<a.length;s++){var c=a[s],f=""+i+s;u.push(f),r[f]={node:c,lastCount:0},n[f]={};for(var l=0;l<o.length;l++){var h=o[l];r[h]&&r[h].node.mode===c.mode?(n[h][f]=tH(r[h].lastCount+c.length,c.mode)-tH(r[h].lastCount,c.mode),r[h].lastCount+=c.length):(r[h]&&(r[h].lastCount=c.length),n[h][f]=tH(c.length,c.mode)+4+q(c.mode,e))}}o=u}for(var d=0;d<o.length;d++)n[o[d]].end=0;return{map:n,table:r}}(function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];switch(n.mode){case F:e.push([n,{data:n.data,mode:S,length:n.length},{data:n.data,mode:D,length:n.length}]);break;case S:e.push([n,{data:n.data,mode:D,length:n.length}]);break;case Q:e.push([n,{data:n.data,mode:D,length:tq(n.data)}]);break;case D:e.push([{data:n.data,mode:D,length:tq(n.data)}])}}return e}(tj(t,l())),e),n=tQ.find_path(r.map,"start","end"),o=[],i=1;i<n.length-1;i++)o.push(r.table[n[i]].node);return tt(o.reduce(function(t,e){var r=t.length-1>=0?t[t.length-1]:null;return r&&r.mode===e.mode?t[t.length-1].data+=e.data:t.push(e),t},[]))},a=function(t,e){if(void 0===t||""===t)throw Error("No input text");var r,n,o,i=g;return void 0!==e&&(i=m(e.errorCorrectionLevel,g),n=J(r=e.version)?parseInt(r,10):void 0,o=x(e.maskPattern),e.toSJISFunc&&f(e.toSJISFunc)),function(t,e,r,n){if(Array.isArray(t))o=tt(t);else if("string"==typeof t){var o,i=e;i||(i=_(tt(tj(t,l())),r)),o=te(t,i||40)}else throw Error("Invalid data");var a=_(o,r);if(!a)throw Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<a)throw Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+a+".\n")}else e=a;var c=function(t,e,r){var n=new tl;r.forEach(function(e){n.put(e.mode.bit,4),n.put(e.getLength(),q(e.mode,t)),e.write(n)});var o=(s(t)-C(t,e))*8;for(n.getLengthInBits()+4<=o&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);for(var i=(o-n.getLengthInBits())/8,a=0;a<i;a++)n.put(a%2?17:236,8);return function(t,e,r){for(var n,o,i=s(e),a=i-C(e,r),u=P(e,r),c=i%u,f=u-c,l=Math.floor(i/u),h=Math.floor(a/u),d=h+1,g=l-h,v=new tm(g),p=0,m=Array(u),w=Array(u),y=0,b=new Uint8Array(t.buffer),E=0;E<u;E++){var x=E<f?h:d;m[E]=b.slice(p,p+x),w[E]=v.encode(m[E]),p+=x,y=Math.max(y,x)}var B=new Uint8Array(i),R=0;for(n=0;n<y;n++)for(o=0;o<u;o++)n<m[o].length&&(B[R++]=m[o][n]);for(n=0;n<g;n++)for(o=0;o<u;o++)B[R++]=w[o][n];return B}(n,t,e)}(e,r,o),f=u(e),h=new td(f);!function(t,e){for(var r=t.size,n=b(e),o=0;o<n.length;o++)for(var i=n[o][0],a=n[o][1],u=-1;u<=7;u++)if(!(i+u<=-1)&&!(r<=i+u))for(var s=-1;s<=7;s++)a+s<=-1||r<=a+s||(u>=0&&u<=6&&(0===s||6===s)||s>=0&&s<=6&&(0===u||6===u)||u>=2&&u<=4&&s>=2&&s<=4?t.set(i+u,a+s,!0,!0):t.set(i+u,a+s,!1,!0))}(h,e);for(var d=h.size,g=8;g<d-8;g++){var v=g%2==0;h.set(g,6,v,!0),h.set(6,g,v,!0)}return!function(t,e){for(var r=y(e),n=0;n<r.length;n++)for(var o=r[n][0],i=r[n][1],a=-2;a<=2;a++)for(var u=-2;u<=2;u++)-2===a||2===a||-2===u||2===u||0===a&&0===u?t.set(o+a,i+u,!0,!0):t.set(o+a,i+u,!1,!0)}(h,e),tZ(h,r,0),e>=7&&function(t,e){for(var r,n,o,i=t.size,a=O(e),u=0;u<18;u++)r=Math.floor(u/3),n=u%3+i-8-3,o=(a>>u&1)==1,t.set(r,n,o,!0),t.set(n,r,o,!0)}(h,e),!function(t,e){for(var r=t.size,n=-1,o=r-1,i=7,a=0,u=r-1;u>0;u-=2)for(6===u&&u--;;){for(var s=0;s<2;s++)if(!t.isReserved(o,u-s)){var c=!1;a<e.length&&(c=(e[a]>>>i&1)==1),t.set(o,u-s,c),-1==--i&&(a++,i=7)}if((o+=n)<0||r<=o){o-=n,n=-n;break}}}(h,c),isNaN(n)&&(n=L(h,tZ.bind(null,h,r))),T(n,h),tZ(h,r,n),{modules:h,version:e,errorCorrectionLevel:r,maskPattern:n,segments:o}}(t,n,i,o)},tn=function(t){t||(t={}),t.color||(t.color={});var e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,n=t.scale||4;return{width:r,scale:r?4:n,margin:e,color:{dark:tG(t.color.dark||"#000000ff"),light:tG(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},to=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},ti=function(t,e){var r=to(t,e);return Math.floor((t+2*e.margin)*r)},ta=function(t,e,r){for(var n=e.modules.size,o=e.modules.data,i=to(n,r),a=Math.floor((n+2*r.margin)*i),u=r.margin*i,s=[r.color.light,r.color.dark],c=0;c<a;c++)for(var f=0;f<a;f++){var l=(c*a+f)*4,h=r.color.light;c>=u&&f>=u&&c<a-u&&f<a-u&&(h=s[+!!o[Math.floor((c-u)/i)*n+Math.floor((f-u)/i)]]),t[l++]=h.r,t[l++]=h.g,t[l++]=h.b,t[l]=h.a}},tr=function(t,e,r){var n,o=r,i=e;void 0!==o||e&&e.getContext||(o=e,e=void 0),e||(i=function(){try{return document.createElement("canvas")}catch(t){throw Error("You need to specify a canvas element")}}()),o=tn(o);var a=ti(t.modules.size,o),u=i.getContext("2d"),s=u.createImageData(a,a);return ta(s.data,t,o),n=i,u.clearRect(0,0,n.width,n.height),n.style||(n.style={}),n.height=a,n.width=a,n.style.height=a+"px",n.style.width=a+"px",u.putImageData(s,0,0),i},tu=function(t,e,r){var n=tn(e),o=t.modules.size,i=t.modules.data,a=o+2*n.margin,u=n.color.light.a?"<path "+tK(n.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",s="<path "+tK(n.color.dark,"stroke")+' d="'+function(t,e,r){for(var n="",o=0,i=!1,a=0,u=0;u<t.length;u++){var s=Math.floor(u%e),c=Math.floor(u/e);s||i||(i=!0),t[u]?(a++,u>0&&s>0&&t[u-1]||(n+=i?tV("M",s+r,.5+c+r):tV("m",o,0),o=0,i=!1),s+1<e&&t[u+1]||(n+=tV("h",a),a=0)):o++}return n}(i,o,n.margin)+'"/>',c='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+('viewBox="0 0 '+a+" ")+a+'" shape-rendering="crispEdges">'+u+s+"</svg>\n";return"function"==typeof r&&r(null,c),c},r=a,n=tY.bind(null,tr),o=tY.bind(null,function(t,e,r){var n=r;void 0!==n||e&&e.getContext||(n=e,e=void 0),n||(n={});var o=tr(t,e,n),i=n.type||"image/png",a=n.rendererOpts||{};return o.toDataURL(i,a.quality)}),i=tY.bind(null,function(t,e,r){return tu(t,r)});var tX=ts&&ts.__esModule?ts.default:ts,t0={ip:null,port:null};function t1(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.getElementById("status");r.className=`flex items-center justify-center p-4 rounded-xl transition-all duration-300 ${({connected:"bg-green-500/20 text-green-300 border-green-500/20",connecting:"bg-yellow-500/20 text-yellow-300 border-yellow-500/20",disconnected:"bg-red-500/20 text-red-300 border-red-500/20",info:"bg-iina-surface text-iina-text border-white/10"})[e]}`,r.innerHTML=`${({connected:"‚úÖ",connecting:'<div class="loading w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin mr-3"></div>',disconnected:"‚ùå",info:"\uD83D\uDCE1"})[e]} <span>${t}</span>`,document.getElementById("serverStatus").textContent=t}window.refreshConnection=function(){t1("Refreshing...","connecting"),window.iina&&window.iina.postMessage&&(console.log("=== WINDOW: Sending refresh request ==="),window.iina.postMessage("refresh",{}))},document.addEventListener("DOMContentLoaded",function(){console.log("=== WINDOW: Initializing IINA communication ==="),console.log("=== WINDOW: Requesting connection info from plugin ==="),iina.postMessage("requestConnection",{}),iina.onMessage("connectionUpdate",function(t){if(console.log("=== WINDOW: Received connectionUpdate ==="),console.log("Connection data:",t),t.ip&&t.port){var r;console.log("=== WINDOW: Valid connection data received ==="),t.port&&(document.getElementById("serverPort").textContent=t.port,t0.port=t.port),t.ip&&(document.getElementById("localIP").textContent=t.ip,t0.ip=t.ip),(r=function(){var t,e;return function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){var c=[u,s];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:if(console.log("generateQRCode called with:",t0),!t0.ip||!t0.port)return console.log("Missing connection data - IP:",t0.ip,"Port:",t0.port),[2];console.log("Generated URL for QR code:",t=`https://lexwolfy.github.io/iina-remote?ip=${t0.ip}&port=${t0.port}`),document.getElementById("connectionUrl").textContent=t,console.log("QRCode library available, generating QR code..."),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,tX.toDataURL(t,{width:200,margin:2,color:{dark:"#1a1a1a",light:"#ffffff"}})];case 2:return e=r.sent(),console.log("QR code generated successfully"),document.getElementById("qrcode").innerHTML=`<img src="${e}" alt="QR Code" class="rounded-lg">`,[3,4];case 3:var n;return console.error("Error generating QR code:",r.sent()),n=0,document.getElementById("qrcode").innerHTML=`
                <div class="text-center p-4 bg-red-100 rounded-lg border border-red-300">
                    <div class="text-4xl mb-2 text-red-600">\u{274C}</div>
                    <p class="text-sm text-red-700 mb-2">QR Code generation failed</p>
                    <p class="text-xs text-red-600">Check browser console for details</p>
                </div>
            `,[3,4];case 4:return[2]}})},function(){var t=this,n=arguments;return new Promise(function(o,i){var a=r.apply(t,n);function u(t){e(a,o,i,u,s,"next",t)}function s(t){e(a,o,i,u,s,"throw",t)}u(void 0)})})(),t1("Server Ready","connected")}else console.log("=== WINDOW: Invalid or pending connection data ==="),t1(t.status||"Waiting for connection...","connecting")}),console.log("=== WINDOW: Message handlers set up ===")})}();</script>

